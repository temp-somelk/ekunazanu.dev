<!doctype html><html lang=en><head><meta charset=utf-8><meta content="width=device-width,initial-scale=1" name=viewport><meta content="Anchit Roy" name=author><meta content="A few things about colours and colour formats." name=description><meta content="Quantifying Colour" property=og:title><meta content=article property=og:type><meta content="A few things about colours and colour formats." property=og:description><meta content=https://ekunazanu.dev/lab/quantifying-colour/ property=og:url><meta content=https://ekunazanu.dev/media/thumbnails/lab.colours.svg.png property=og:image><meta content="Red, green and blue lines representing a computer screen." property=og:image:alt><meta content=image/png property=og:image:type><meta content=1200 property=og:image:width><meta content=900 property=og:image:height><meta content=en_US property=og:locale><meta content=ekunazanu property=og:site_name><title>Quantifying Colour</title><link href=https://ekunazanu.dev/lab/quantifying-colour/ rel=cannonical><link href=https://ekunazanu.dev/atom.xml rel=alternate type=application/atom+xml><link href=https://ekunazanu.dev/misc/main.css rel=stylesheet><link href=https://ekunazanu.dev/misc/lab.favicon.png rel=icon><meta content=Zola name=generator><body><nav><ul><li><h2><a href=https://ekunazanu.dev>ekunazanu.dev</a></h2><li><a href=https://ekunazanu.dev/log>Log</a><li><a href=https://ekunazanu.dev/lab>Lab</a> ⟶</ul></nav><div class=print>https://ekunazanu.dev</div><main><article><h1>Quantifying Colour</h1><p>There’s a lot of different ways to describe colours. But to pinpoint an exact colour, there needs to be a standard way to represent it. Even some surface level research about the topic reveals that there’s extensive science and math behind this seemingly simple task.<p>Before quantifying colours, it is important to first define what colours even are. <a rel="noopener nofollow noreferrer" href=https://en.wikipedia.org/wiki/Color target=_blank>Wikipedia</a> defines it as “The visual perception based on the electromagnetic spectrum”. So a colour depends on the perception of the viewer, as well as the electromagnetic spectrum — or in plain language, light.<h2 id=Spectral_Power_Distribution>Spectral Power Distribution</h2><p>Light is made up of <a rel="noopener nofollow noreferrer" href=https://en.wikipedia.org/wiki/Photon target=_blank>photons</a>. These can thought of as abstract particles carrying specific amounts of energy — determined by their <a rel="noopener nofollow noreferrer" href=https://en.wikipedia.org/wiki/Photon_energy#Physics target=_blank>wavelength or freuqency</a>.</p><svg viewbox="0 0 200 75" fill=none height=450px id=bitarraySVG width=1200px><desc>Bit array.</desc><rect fill=#aaa height=150 id=bitarrayBG width=200 x=0 y=0 /></svg><details><summary>Photon wave-particle duality</summary> The above is an interpretation of a photon, and is not necessarily accurate. The exact shape of photons is difficult to describe since photons exhibit <a rel="noopener nofollow noreferrer" href=https://en.wikipedia.org/wiki/Wave%E2%80%93particle_duality#Wave-particle_duality_of_light target=_blank>both particle and wave-like behaviour</a>. Trying to visualize photons as both as a particle and a wave can get very tricky very quickly.</details><p>The different wavelengths of photons together form the <a rel="noopener nofollow noreferrer" href=https://en.wikipedia.org/wiki/Electromagnetic_spectrum target=_blank>electromagnetic spectrum</a>. It is simply the full range photons of different energies, ordered by wavelength.</p><svg viewbox="0 0 200 75" fill=none height=450px id=bitarraySVG width=1200px><desc>Bit array.</desc><rect fill=#aaa height=150 id=bitarrayBG width=200 x=0 y=0 /></svg><p>Since photons carry energy, any body that radiate photons also radiate energy. The rate of energy transferred via photons can be measured as <a rel="noopener nofollow noreferrer" href=https://en.wikipedia.org/wiki/Power_(physics) target=_blank>power</a>.</p><svg viewbox="0 0 200 75" fill=none height=450px id=bitarraySVG width=1200px><desc>Bit array.</desc><rect fill=#aaa height=150 id=bitarrayBG width=200 x=0 y=0 /></svg><p>If the power per unit area, or the <a rel="noopener nofollow noreferrer" href=https://en.wikipedia.org/wiki/Intensity_(physics) target=_blank>intensity</a> is plotted per wavelength for a body radiating photons of different wavelengths, then the resulting curve yields its <a rel="noopener nofollow noreferrer" href=https://en.wikipedia.org/wiki/Spectral_power_distribution target=_blank>spectral power distribution</a>.</p><svg viewbox="0 0 200 75" fill=none height=450px id=bitarraySVG width=1200px><desc>Bit array.</desc><rect fill=#aaa height=150 id=bitarrayBG width=200 x=0 y=0 /></svg><p>The spectral power distribution is fundamenetal to determining the ‘colour’ of an object.<h2 id=Photoreceptor_Cells>Photoreceptor Cells</h2><p>The sun too radiates a large amount of photons, and the spectral power distribution of the sun appears similar to this:</p><svg viewbox="0 0 200 75" fill=none height=450px id=bitarraySVG width=1200px><desc>Bit array.</desc><rect fill=#aaa height=150 id=bitarrayBG width=200 x=0 y=0 /></svg><p>The intensity peaks near 500nm. Human eyes naturally evolved to become sensitive to photons with these wavelengths — different kinds of <a rel="noopener nofollow noreferrer" href=https://en.wikipedia.org/wiki/Photoreceptor_cell target=_blank>photoreceptor cells</a> have evolved to become sensitive to photons of wavelengths from 400nm to around 700nm. Depending on the energy carried by the photons (their wavelength and intensity), they can ‘excite’ the photoreceptor cells to produce a specific response.<p>The human eye has two kinds of photoreceptor cells — <a rel="noopener nofollow noreferrer" href=https://en.wikipedia.org/wiki/Rod_cell target=_blank>rod cells</a> and three types of <a rel="noopener nofollow noreferrer" href=https://en.wikipedia.org/wiki/Cone_cell target=_blank>cone cells</a>. The different types of photoreceptor cells are sensitive to different wavelengths of light by differing amounts — some cone cells (S-cones) will not produce a significant response to lights with longer wavelengths but other types (L-cones) will. The <a rel="noopener nofollow noreferrer" href=https://en.wikipedia.org/wiki/Spectral_sensitivity target=_blank>sensitivity</a> curves of the different photoreceptor cells are shown below:</p><svg viewbox="0 0 200 75" fill=none height=450px id=bitarraySVG width=1200px><desc>Bit array.</desc><rect fill=#aaa height=150 id=bitarrayBG width=200 x=0 y=0 /></svg><details open><summary>Normalized curves</summary> The sensitivity of S-cones is significantly lower compared to the other cones. Similarly, rods are relatively more sensitive to light than cones. However, the sensitivity curves are normalized, such that the curves have equal areas under the curves — to make subsequent calculations simpler.</details><p>The response of the photoreceptor cells to lights of different wavelengths is dependent on the spectral power distribution of the incident light, and the sensitivty of the rods and cones. The responses generated by the different types of photoreceptor cells for <a rel="noopener nofollow noreferrer" href=https://en.wikipedia.org/wiki/Monochromatic_radiation target=_blank>monochromatic light</a> (light with near singular wavelength) is shown below:</p><svg viewbox="0 0 200 75" fill=none height=450px id=bitarraySVG width=1200px><desc>Bit array.</desc><rect fill=#aaa height=150 id=bitarrayBG width=200 x=0 y=0 /></svg><details open><summary>Photoreceptor cell responses</summary> The response curve of the types of photoreceptor cells is the <a rel="noopener nofollow noreferrer" href=https://en.wikipedia.org/wiki/Pointwise#Examples target=_blank>point-wise product</a> of the spectral power distribution curve and the photoreceptor sensitivity curves. The overall response from each type of photoreceptor cell is the total area under their corresponding response curves.</details><p>Light with differing intensity and wavelengths produce different and unique responses in the three types of cones. The <a rel="noopener nofollow noreferrer" href=https://en.wikipedia.org/wiki/Color_vision#Theories target=_blank>different responses are perceived by the brain</a> as a colour.</p><svg viewbox="0 0 200 75" fill=none height=450px id=bitarraySVG width=1200px><desc>Bit array.</desc><rect fill=#aaa height=150 id=bitarrayBG width=200 x=0 y=0 /></svg><details open><summary>Colour Classifications</summary> There can be more or fewer colour names for these wavelengths depending on the <a rel="noopener nofollow noreferrer" href=https://en.wikipedia.org/wiki/Spectral_color#Spectral_color_terms target=_blank>classification</a>.</details><p>Rods do not have a big effect on colour perception. In <a rel="noopener nofollow noreferrer" href=https://en.wikipedia.org/wiki/Photopic_vision target=_blank>well-lit conditions</a>, the cones might produce different responses based on the wavelength of light. But in such conditions, the rod cells produce a saturated response since rods are more sensitive to light than cones. As the response of rods in bright environments is indifferent to wavelengths, it cannot differentiate between distinct wavelengths, and threfore does not have a major impact on colour perception — in bright conditions.</p><svg viewbox="0 0 200 75" fill=none height=450px id=bitarraySVG width=1200px><desc>Bit array.</desc><rect fill=#aaa height=150 id=bitarrayBG width=200 x=0 y=0 /></svg><details open><summary>Saturated response</summary> The response from rods remain saturated, and no meaningful information about the wavelength is obtained from the response. Cones on the other hand, respond differently to different wavelengths, and the different responses can be interpreted by the brain as different wavelengths.</details><p>In <a rel="noopener nofollow noreferrer" href=https://en.wikipedia.org/wiki/Scotopic_vision target=_blank>darker environments</a>, rods produce a response when cones may not. But since there is only one type of rod cells, all rods have almost identical sensitivity curves. So, it is not possible to distinguish between different wavelengths and intensities of light — two light sources with different wavelengths and intensities can produce the same response in rods. There is no way to differentiate between different wavelengths and intensity of light and the brain evolved to perceive the response of the rods as a singular luminance value. So ‘colours’ appear different shades of grey in the dark.</p><svg viewbox="0 0 200 75" fill=none height=450px id=bitarraySVG width=1200px><desc>Bit array.</desc><rect fill=#aaa height=150 id=bitarrayBG width=200 x=0 y=0 /></svg><details open><summary>Wavelength ambiguity</summary> Two light sources with <a href=switch#>different wavelengths</a> produce a similar response in rods, and are thus perceived as similar by the brain. This is only if their intensities are not enough to adequately excite the cone cells.</details><p>Since rods cannot differentiate between different wavelengths of light, they do not play a role in colour perception — regardless of whether it is dark or bright.<h3 id=Colour_Blindness>Colour Blindness</h3><p>Sometimes cone cells too may not be able to differentiate between different wavelengths of light. This can happen due to missing cones, or cones with overlapping sensitivity curves. Without the third cone, differentiating between certain wavlengths of light is not possible — which manifests as <a rel="noopener nofollow noreferrer" href=https://en.wikipedia.org/wiki/Color_blindness target=_blank>colour blindess</a>.</p><svg viewbox="0 0 200 75" fill=none height=450px id=bitarraySVG width=1200px><desc>Bit array.</desc><rect fill=#aaa height=150 id=bitarrayBG width=200 x=0 y=0 /></svg><details open><summary>Wavelength ambiguity</summary> Wavelengths <a href=switch#>XXXnm and YYYnm</a> produce a similar responses in cones, and are perceived as similar colours.</details><p>The type of cone anomaly determines the type of colour blindness. The L-cones can shift their response curves slightly towards shorter wavelengths (<a href=https://ekunazanu.dev/lab/quantifying-colour/switch#>protanomaly</a>), or the M-cones shift their response curves towards longer wavelengths (<a href=https://ekunazanu.dev/lab/quantifying-colour/switch#>deuteranomaly</a>). People may also lack functional L-cones (<a href=https://ekunazanu.dev/lab/quantifying-colour/switch#>protanopia</a>) or M-cones (<a href=https://ekunazanu.dev/lab/quantifying-colour/switch#>deuteranopia</a>) entirely. The result is similar in all the cases — reds and greens look similar, to almost identical. In very rare cases, people may have anomalous S-cones, resulting in <a href=https://ekunazanu.dev/lab/quantifying-colour/switch#>tritanomaly</a> and <a href=https://ekunazanu.dev/lab/quantifying-colour/switch#>tritanopia</a>. In even rarer cases, people may <a href=https://ekunazanu.dev/lab/quantifying-colour/switch#>only have S-cones</a>, or <a href=https://ekunazanu.dev/lab/quantifying-colour/switch#>no cone cells at all</a> — resulting in <a rel="noopener nofollow noreferrer" href=https://en.wikipedia.org/wiki/Monochromacy#Humans target=_blank>total colour blindess</a>.</p><svg viewbox="0 0 200 75" fill=none height=450px id=bitarraySVG width=1200px><desc>Bit array.</desc><rect fill=#aaa height=150 id=bitarrayBG width=200 x=0 y=0 /></svg><h3 id=Non-Spectral_Colours>Non-Spectral Colours</h3><p>All the examples in the above subsections were about <a rel="noopener nofollow noreferrer" href=https://en.wikipedia.org/wiki/Spectral_color target=_blank>spectral colours</a> — light with very narrow bands of wavelengths. But not all colours are spectral colours. Greys and purples are non-spectral colours that cannot be created using only monochromatic light.<p>The spectral power distribution of non-spectral colours is not a single spike at a specfic wavelength, unlike spectral colours:</p><svg viewbox="0 0 200 75" fill=none height=450px id=bitarraySVG width=1200px><desc>Bit array.</desc><rect fill=#aaa height=150 id=bitarrayBG width=200 x=0 y=0 /></svg><p>The set of responses from the cones for non-spectral colours like magenta or grey is different from the set of responses produced by the cones for spectral colours. The brain perceives these unique set of responses from the cones as a separate colour.<p>Try finding a spectral colour that has an identical response as magenta. It is impossible:</p><svg viewbox="0 0 200 75" fill=none height=450px id=bitarraySVG width=1200px><desc>Bit array.</desc><rect fill=#aaa height=150 id=bitarrayBG width=200 x=0 y=0 /></svg><p><a href=https://ekunazanu.dev/lab/quantifying-colour/switch#>Greys</a> and <a href=https://ekunazanu.dev/lab/quantifying-colour/switch#>pinks</a> too, are composed of light with multiple wavelengths. In both cases, the response of the cones is again unique and different — from the responses generated by monochromatic light.</p><svg viewbox="0 0 200 75" fill=none height=450px id=bitarraySVG width=1200px><desc>Bit array.</desc><rect fill=#aaa height=150 id=bitarrayBG width=200 x=0 y=0 /></svg><h3 id=Metamerism>Metamerism</h3><p>In the above cases, various wavelengths of light together created unique responses in cones, which is different from the responses when cones are exposed to monochromatic light. However, multiple wavelengths of light together can also produce a response that is not unique, but very similar to the response of a spectral colour.<p>Empirical data from colour matching experiments by <a rel="noopener nofollow noreferrer" href=https://doi.org/10.1088/1475-4878/30/4/301 target=_blank>William David Wright</a> and <a rel="noopener nofollow noreferrer" href=https://doi.org/10.1098/rsta.1932.0005 target=_blank>John Guild</a> mapped light consisting of three wavelengths (435nm, 546nm, and 700nm) to spectral colours — by varying the intensities of its constituent monochromatic lights such that the resultant light was perceived to be the same as a spectral colour. The findings were then summarised, and the observations resulted in the colour-matching curves.</p><svg viewbox="0 0 200 75" fill=none height=450px id=bitarraySVG width=1200px><desc>Bit array.</desc><rect fill=#aaa height=150 id=bitarrayBG width=200 x=0 y=0 /></svg><details open><summary>Negative intensity</summary> Adding colours to one side is equivalent to sutracting colours from the other side, inferring from <a rel="noopener nofollow noreferrer" href=https://en.wikipedia.org/wiki/Grassmann%27s_laws_(color_science) target=_blank>Grassman’s laws</a>. In the colour matching experiment, adding light to the spectral colour being compared is represented as subtracting from the colour matching function curves — resulting in negative intensity. <p>Physically, it is impossible to create light with negative intensity, so it is impossible to reproduce certain colours using only three wavelengths of light. However, colours can still be represented <em>theoretically</em> using negative values.</details><p>The three wavelengths of light together produce identical responses to spectral colours in the cones — making them appear similar. So certain spectral colours can be recreated using only three monochromatic sources of light. But there is also a subset of spectral colours which cannot be replicated using only the three wavelengths of light.<p>While the experiment had used three spectral colours to replicate most spectral colours, the same three wavelengths can also be used to replicate non-spectral colours. Light with other wavelengths or different spectral power distibutions can be used to reproduce other spectral and non-spectral colours as well. In general, bodies with <a href=https://ekunazanu.dev/lab/quantifying-colour/switch#below>different spectral power distributions</a> can be perceived as same colours as long as they generate identical responses in cones. This phenomenon is called <a rel="noopener nofollow noreferrer" href=https://en.wikipedia.org/wiki/Metamerism_(colour) target=_blank>metamerism</a>.</p><svg viewbox="0 0 200 75" fill=none height=450px id=bitarraySVG width=1200px><desc>Bit array.</desc><rect fill=#aaa height=150 id=bitarrayBG width=200 x=0 y=0 /></svg><h2 id=Colour_Space>Colour Space</h2><p>Since the responses generated by the L-cones, M-cones, and S-cones correspond to a colour, a set of (L,M,S) values can identify a colour. The set of (L,M,S) values can also be mapped as points in a three dimensional space — a colour can be described as a point on this space. As this space can describe colours, it is aptly called a <a rel="noopener nofollow noreferrer" href=https://en.wikipedia.org/wiki/Color_space target=_blank>colour space</a>.<details><summary>Measuring LMS values</summary> The (L,M,S) values is the total response of their respective cones. The total response of each cone is simply the area under their corresponding response curves, and the response curves of the cones are the pointwise product of their normalized sensitivity curves and the spectral power distribution. So, if <code>J(λ)</code> is the spectral power distrubtion of the light source, and <code>l(λ)</code>, <code>m(λ)</code>, and <code>s(λ)</code> are the sensitivity curves of the L-cones, M-cones, and S-cones — then the L, M, and S values is given by:<br> <code>L = ∫ J(λ)·l(λ) dλ</code><br> <code>M = ∫ J(λ)·m(λ) dλ</code><br> <code>S = ∫ J(λ)·s(λ) dλ</code></details><p>In this case, the colour space is the <a rel="noopener nofollow noreferrer" href=https://en.wikipedia.org/wiki/LMS_color_space target=_blank>LMS colur space</a> — where a colour can be described as a set of (L,M,S) values in this space.</p><svg viewbox="0 0 200 75" fill=none height=450px id=bitarraySVG width=1200px><desc>Bit array.</desc><rect fill=#aaa height=150 id=bitarrayBG width=200 x=0 y=0 /></svg><details open><summary>Impossible colours</summary> While all colours can be represented using LMS values, the reverse is not always true. Not all LMS values correspond to perceivable colours. The sensitivity curves of the M-cones overlaps the sensitivity curves of L-cones and S-cones. Any type of light that excites the M-cones, must also excite the L-cones, or S-cones, or both. So ‘colours’ having LMS values such as (0,1,0) are <a rel="noopener nofollow noreferrer" href=https://en.wikipedia.org/wiki/Impossible_color#Imaginary_colors target=_blank>imaginary</a> and physically impossible.</details><p>The LMS colour space is one way to describe colours. But there are other ways as well. While fundamental, the LMS colour space is not the standard reference for describing colours — it is the <a rel="noopener nofollow noreferrer" href=https://en.wikipedia.org/wiki/CIE_1931_color_space target=_blank>CIE 1931 colour spaces</a>.<h3 id=CIE_1931>CIE 1931</h3><p>In the Wright-Guild colour matching experiments, three wavelengths of light were used to recreate spectral colours by varying the intensity of the individual constituent lights. The same three wavelengths can also be used to produce non-spectral colours.<p>All these spectral and non-spectral colours can again be represented as a set of three intensity values — for each of the three wavelengths. The set of intensity values can again be represented as points in some space. Colours can be described as points in this space as well, and this colour space is called the <a rel="noopener nofollow noreferrer" href=https://en.wikipedia.org/wiki/CIE_1931_color_space#CIE_RGB_color_space target=_blank>CIE RGB colour space</a>.</p><svg viewbox="0 0 200 75" fill=none height=450px id=bitarraySVG width=1200px><desc>Bit array.</desc><rect fill=#aaa height=150 id=bitarrayBG width=200 x=0 y=0 /></svg><details open><summary>CIE RGB space bases</summary> The CIE RGB colour space uses as lights of 700nm (R), 546nm (G), and 435nm (B) as its <a rel="noopener nofollow noreferrer" href=https://en.wikipedia.org/wiki/Primary_color#Real_primaries target=_blank>primaries</a> (colours used to recreate other colours). The LMS colour space, in contrast, used the response of the cones (L,M,S) as its bases.</details><p>Mapping spectral colours in the CIE RGB colour space results in the <a rel="noopener nofollow noreferrer" href=https://en.wikipedia.org/wiki/Spectral_color#In_color_spaces target=_blank>spectral locus</a>. This curve represents the intensity of RGB primaries required to replicate spectral colours — it is simply the Wright-Guild colour-matching curves mapped in the CIE RGB colour space.</p><svg viewbox="0 0 200 75" fill=none height=450px id=bitarraySVG width=1200px><desc>Bit array.</desc><rect fill=#aaa height=150 id=bitarrayBG width=200 x=0 y=0 /></svg><p>Because of the way the colour space is constructed, parts of the spectral locus have negative RGB values. This means that certain spectral (and non-spectral) colours have to be described using negative values in the CIE RGB colour space.<p>It was decided that a colour space that could map all colours to non-negative values would have been preferable. But instead of conducting more experiments to construct a new colour space, the existing CIE RGB colour space could also be transformed using simple linear transformations. The transformation of the three dimensional colour space can then be defined by a 3x3 matrix:</p><svg viewbox="0 0 200 75" fill=none height=450px id=bitarraySVG width=1200px><desc>Bit array.</desc><rect fill=#aaa height=150 id=bitarrayBG width=200 x=0 y=0 /></svg><details open><summary>Colour space transformations</summary> Linear transformation of colour spaces is possible since human colour perception is nearly linear. The linearity of colour perception in humans is again inferred from Grassman’s laws.</details><p><a href=https://ekunazanu.dev/lab/quantifying-colour/switch#transformToXYZ>Transforming</a> the space means the new space is now defined by different new bases or new primaries. Earlier, some spectral colours had to be defined by negative values of a primary, but now the same colour is defined by positive values. It suggests that the coordinate system (the primaries) itself has to contain some sort of a negative intensity. But it is impossible for light to have negative intensity, implying that the primaries for the new colour cannot physically exist, and are imaginary.<p>Since the primaries of the new colour space are imaginary, it is reasonable to define the new primaries to represent more abstract concepts instead of physical quantities. Again, it was decided that one of the primaries would define the <a rel="noopener nofollow noreferrer" href=https://en.wikipedia.org/wiki/Luminance target=_blank>luminance</a> of the colour, and the other two can be used to derive its <a rel="noopener nofollow noreferrer" href=https://en.wikipedia.org/wiki/Chromaticity target=_blank>chromaticity</a>. The primaries of this new colours space are named X, Y, and Z — and the resulting colour space is called <a rel="noopener nofollow noreferrer" href=https://en.wikipedia.org/wiki/CIE_1931_color_space#Meaning_of_X,_Y_and_Z target=_blank>CIE XYZ colour space</a>. The Y primary represents the luminance of a colour, while the X and Z primaries are used to derive its chromaticity.<details><summary>Luminance and chromaticity</summary> Luminance refers to the perceived brightness of a colour, while chromaticity is analogous to hues. According to the <a rel="noopener nofollow noreferrer" href=https://en.wikipedia.org/wiki/Opponent_process target=_blank>opponent process</a> theory, colours are perceieved as pairs of opposing colours — red vs green, blue vs yellow (chromaticity), and black vs white (luminance). Hence, it is possible to describe a colour by how red it is compared to how green it is, how blue it is compared to how yellow it is, and how bright the overall colour is — ie. defining colours based on luminance and chromaticity values.</details><p>Similar to how the sensitivity of different cones can be measured, the average sensitivity of all the cones can also be measured — resulting in a curve that effectively functions as a <a rel="noopener nofollow noreferrer" href=https://en.wikipedia.org/wiki/Luminous_efficiency_function target=_blank>luminosity sensitivity curve</a>:</p><svg viewbox="0 0 200 75" fill=none height=450px id=bitarraySVG width=1200px><desc>Bit array.</desc><rect fill=#aaa height=150 id=bitarrayBG width=200 x=0 y=0 /></svg><p>This curve can also be approximated as a weighted sum of the individual RGB colour matching function curves:</p><svg viewbox="0 0 200 75" fill=none height=450px id=bitarraySVG width=1200px><desc>Bit array.</desc><rect fill=#aaa height=150 id=bitarrayBG width=200 x=0 y=0 /></svg><p>The <a href=https://ekunazanu.dev/lab/quantifying-colour/switch#above>factors</a> represent how much the RGB primaries contribute to the overall brightness or luminance of a colour. But the luminance of a colour is the Y primary in the XYZ colour space. So the factors represent how much each of the RGB primaries contribute to the Y primary in the XYZ colour space — and forms one row of the transformation matrix:</p><svg viewbox="0 0 200 75" fill=none height=450px id=bitarraySVG width=1200px><desc>Bit array.</desc><rect fill=#aaa height=150 id=bitarrayBG width=200 x=0 y=0 /></svg><p>The X and Z primaries was defined such that the new colour space fulfilled <a rel="noopener nofollow noreferrer" href=https://en.wikipedia.org/wiki/CIE_1931_color_space#Construction_of_the_CIE_XYZ_color_space_from_the_Wright%E2%80%93Guild_data target=_blank>other certain properties</a> decided by the CIE — resulting in a transformation matrix with values:</p><svg viewbox="0 0 200 75" fill=none height=450px id=bitarraySVG width=1200px><desc>Bit array.</desc><rect fill=#aaa height=150 id=bitarrayBG width=200 x=0 y=0 /></svg><p>The X and Z primaries do not directly represent the chromaticity of a colour, but can be used to derive it. To understand how the X and Z primaries can be used to derive the chromaticity in the CIE XYZ colour space, it first helps to understand how the same can be achieved in the CIE RBG colour space.<h3 id=Chromaticity>Chromaticity</h3><p>In the CIE RGB colour space, the sum of the intensity of its primaries (R+G+B) can act as a crude approximation for luminance of a colour, while the ratios between the intensities of the RGB primaries can serve as an approximation for a colour’s chromaticity. The ratios r, g, b representing the chromaticity of the R, G, B primaries respectively can then be calculated by normalizing out the total intensity of the primaries:<p><code>r = R/(R+G+B)</code><br> <code>g = G/(R+G+B)</code><br> <code>b = B/(R+G+B)</code><details><summary>Luminance-chromaticity estimates</summary> While the luminance and chromaticity are approximations, it does not mean that there is loss of information. The exact RGB values can be recreated using the luminance and chromaticity estimates. The approximation simply refers to the imperfect separation of luminance and chromaticity.</details><p>In the CIE RGB colour space, all the colours with a luminosity value of one will lie on the plane R+G+B = 1. The plane is a triangle bounded by the points (1,0,0), (0,1,0), and (0,0,1).</p><svg viewbox="0 0 200 75" fill=none height=450px id=bitarraySVG width=1200px><desc>Bit array.</desc><rect fill=#aaa height=150 id=bitarrayBG width=200 x=0 y=0 /></svg><p>The chromaticity values (r,g,b) of the colours on this plane are simply the (R,G,B) values, since the luminosity is one — the ratios are already normalized.</p><svg viewbox="0 0 200 75" fill=none height=450px id=bitarraySVG width=1200px><desc>Bit array.</desc><rect fill=#aaa height=150 id=bitarrayBG width=200 x=0 y=0 /></svg><p>A colour having some other luminance k would lie on the plane R+G+B = k — the plane in the CIE RGB colour space bounded by (k,0,0), (0,k,0,), and (0,0,k). The chromaticity values (r,g,b) are derived by normalizing the (R,G,B) values. Geometrically, it is the same as scaling the plane, or projecting the point on the R+G+B = 1 plane.</p><svg viewbox="0 0 200 75" fill=none height=450px id=bitarraySVG width=1200px><desc>Bit array.</desc><rect fill=#aaa height=150 id=bitarrayBG width=200 x=0 y=0 /></svg><details><summary>Dimensionality reduction</summary> The line connecting a point (R,G,B) to the origin (0,0,0) can be thought of as lines of chromaticity. Points on the same line but at different distances represent colours with the same chromaticity but different luminance values. The (r,g,b) values are the projection of the points on the R+G+B =1 plane — so colours having the same chromaticity but different luminance values get projected on the same point, leading to <a rel="noopener nofollow noreferrer" href=https://en.wikipedia.org/wiki/Dimensionality_reduction target=_blank>loss of information</a>. <p>The chromaticity plane contains information about chromaticity, and generally does not contain any information about luminance. So unless luminance is explicitly specified, it is impossible to recreate the corresponding RGB values using just the (r,g,b) values.</details><p>Since (r,g,b) values denote ratios, r+g+b is always equal to one. It makes one of the three values redundant. Knowing two, the third can be deduced by subtracting the other two values from one. The values for r and g are kept, and b is discarded. Geometrically, it can be represented by projecting points on the R+G+B = 1 plane to the RG plane.</p><svg viewbox="0 0 200 75" fill=none height=450px id=bitarraySVG width=1200px><desc>Bit array.</desc><rect fill=#aaa height=150 id=bitarrayBG width=200 x=0 y=0 /></svg><details open><summary>The rg plane</summary> While the points are projected on the RG plane, it is represented as the rg plane because RG and rg represent different quantities. The values (r,g) represent the chromaticity of a colour, while (R,G) values represent the intensity of R and G primaries.</details><p>These projections result in a chromaticity plane that describes the chromaticity of a colour using (r,g) values. However, the <a rel="noopener nofollow noreferrer" href=https://en.wikipedia.org/wiki/Rg_chromaticity target=_blank>rg chromaticity space</a> cannot describe all possible chromaticity of colours with positive values since the CIE RGB colour space itself cannot. But the same idea can be translated for the CIE XYZ colour space.<p>Similar to how colours were projected on the rg plane in the CIE RGB colour space, the same can be projected on the xy plane in the CIE XYZ colour space. However in this colour space, the bases are imaginary and the only colours that have been mapped so far are the spectral colours. So the chromaticity of spectral colours are first mapped on the xy plane.</p><svg viewbox="0 0 200 75" fill=none height=450px id=bitarraySVG width=1200px><desc>Bit array.</desc><rect fill=#aaa height=150 id=bitarrayBG width=200 x=0 y=0 /></svg><details open><summary>Meaning of xy</summary> The nomenclature used in the CIE XYZ colour space to describe the chromaticity of colours is analagous to the naming convention used in the CIE RGB colour space. So <code>x = X/(X+Y+Z)</code> and <code>y = Y/(X+Y+Z)</code>.</details><p>If two points can define a line in the xy plane, a point on that line can be represented as the ratio of these two points:</p><svg viewbox="0 0 200 75" fill=none height=450px id=bitarraySVG width=1200px><desc>Bit array.</desc><rect fill=#aaa height=150 id=bitarrayBG width=200 x=0 y=0 /></svg><p>But the line can also <a href=https://ekunazanu.dev/lab/quantifying-colour/switch#below>intersect the spectral locus</a>. Then, the point can also be represented as the ratio of the points on the spectral locus:</p><svg viewbox="0 0 200 75" fill=none height=450px id=bitarraySVG width=1200px><desc>Bit array.</desc><rect fill=#aaa height=150 id=bitarrayBG width=200 x=0 y=0 /></svg><p>But the points on spectral locus represent the chromaticity of spectral colours — colours which can be physically perceived. A point in the xy plane can be defined as (x,y) values or as the ratio between the intensity of two (or more) spectral colours.<details><summary>Colour perception linearity</summary> The ratio between the intensity of the primaries, ie. (x,y) values, is equal to the ratio between the intensity of the spectal colours because colour perception is linear. The near linearity of human colour perception is again inferred from Grassman’s laws.</details><p>All the points inside the spectral locus are all non-spectral colours and their chromaticity can be represented as the ratio between the intensity of other spectral colours. If all these colours, along with all the spectral colours are mapped in the xy plane, it results in the <a rel="noopener nofollow noreferrer" href=https://en.wikipedia.org/wiki/CIE_1931_color_space#/media/File:CIE1931xy_blank.svg target=_blank>CIE xy chromaticity diagram</a>:</p><svg viewbox="0 0 200 75" fill=none height=450px id=bitarraySVG width=1200px><desc>Bit array.</desc><rect fill=#aaa height=150 id=bitarrayBG width=200 x=0 y=0 /></svg><p>The chromaticity (and colours) outside the spectral locus are imaginary, but all the points inside contain the chromaticity of all colours perceviable by an average human. As the CIE xy chromaticity diagram can represent all perceivable chromaticities, it is often used for comparing other colour spaces.<details><summary>The xy plane to compare colour spaces</summary> The xy chromaticity diagram represents a <em>chromaticity</em> space, not a <em>colour</em> space. Using a chromaticity space to compare colour spaces is not perfectly accurate, since luminance information cannot be compared. However comparing chromaticity information is simpler, and sufficient in certain cases. For a more complete comparison of colour spaces, the CIE XYZ colour space is generally used as the standard reference instead.</details><details><summary>CIE xyY colour space</summary> The CIE xy chromaticity diagram represents chromaticity, but not colours since there is no information about luminance. Adding a luminance component allows it to represent colours, forming a colours space. In the RGB colour space the luminance of a colour was approximated as the sum of the primaries, but in CIE XYZ space the luminance is already somewhat accurately described by the Y primary — which means it can be represented using the Y primary. The chromaticity (x,y) along with luminance Y forms the CIE xyY colour space.</details><h2 id=Gamut>Gamut</h2><p>As mentioned, the chromaticity of a colour can be described by the ratio of the intensity of two monochromatic colours. Conversely, two monochromatic light sources can produce colours having a chromaticity that lies on the line joining the corresponding two points in the CIE xy plane:</p><svg viewbox="0 0 200 75" fill=none height=450px id=bitarraySVG width=1200px><desc>Bit array.</desc><rect fill=#aaa height=150 id=bitarrayBG width=200 x=0 y=0 /></svg><p>Adding a third monochromatic light allows for more combinations of ratios of among the primaries — greatly expanding the chromaticty of colours that can be recreated:</p><svg viewbox="0 0 200 75" fill=none height=450px id=bitarraySVG width=1200px><desc>Bit array.</desc><rect fill=#aaa height=150 id=bitarrayBG width=200 x=0 y=0 /></svg><p>Using more sources of monochromatic light generally results in a bigger chromaticity space that can be physically recreated by the light sources:</p><svg viewbox="0 0 200 75" fill=none height=450px id=bitarraySVG width=1200px><desc>Bit array.</desc><rect fill=#aaa height=150 id=bitarrayBG width=200 x=0 y=0 /></svg><p>The primaries define a <a rel="noopener nofollow noreferrer" href=https://en.wikipedia.org/wiki/Convex_polygon target=_blank>convex polygon</a>, which represents the chromaticity of colours that can be physically recreated by the primaries. This range of colours (chromaticities) that the primaries can produce is called its <a rel="noopener nofollow noreferrer" href=https://en.wikipedia.org/wiki/Gamut target=_blank>gamut</a>. Points lying outside the polygon cannot be physically created, since it would require creating light with negative intensity.<p>The gamut of the original CIE RGB primaries on the CIE xy chromaticity diagram would then look like this:</p><svg viewbox="0 0 200 75" fill=none height=450px id=bitarraySVG width=1200px><desc>Bit array.</desc><rect fill=#aaa height=150 id=bitarrayBG width=200 x=0 y=0 /></svg><details open><summary>CIE RGB chromaticity gamut</summary> It has been stated that the CIE RGB cannot physically reproduce certain colours and this is yet another representation of the same idea. Although in this case, the diagram represents the <em>chromaticities</em> that cannot be reproduced, instead of the exact colours.</details><p>The gamut of the display devices depends on its primaries. It is economically efficient to use just three primaries — which are not purely monochromatic. Certain colour spaces are designed keeping such gamut constraints in mind, such as the <a rel="noopener nofollow noreferrer" href=https://en.wikipedia.org/wiki/SRGB target=_blank>sRGB</a> colour space or the <a rel="noopener nofollow noreferrer" href=https://en.wikipedia.org/wiki/DCI-P3 target=_blank>DCI-P3</a> colour space.</p><svg viewbox="0 0 200 75" fill=none height=450px id=bitarraySVG width=1200px><desc>Bit array.</desc><rect fill=#aaa height=150 id=bitarrayBG width=200 x=0 y=0 /></svg><details open><summary>Gamut & Colour space</summary> Gamut refers to the set of colours that can be physically recreated by an output device, while a colour space is simply a mathematical model used to describe colours. Colour spaces may arbitrarily restrict itself to certain values to more accurately represent physical and economic constraints.</details><h2 id=White_Point>White Point</h2><p>Back to some physical science — all bodies radiate photons, due to <a rel="noopener nofollow noreferrer" href=https://en.wikipedia.org/wiki/Black-body_radiation target=_blank>blackbody radiation</a>. The spectral power distribution of the radiation is a <a rel="noopener nofollow noreferrer" href=https://en.wikipedia.org/wiki/Planck%27s_law#The_law target=_blank>function of temperature</a>:</p><svg viewbox="0 0 200 75" fill=none height=450px id=bitarraySVG width=1200px><desc>Bit array.</desc><rect fill=#aaa height=150 id=bitarrayBG width=200 x=0 y=0 /></svg><details open><summary>Blackbody</summary> A blackbody is an idealized body that does not reflect any light and only emits blackbody radiation. Most bodies in the universe are not technically not (perfect) blackbodies, but approximating it as such is still useful nonetheless.</details><p>The spectral power distribution of the radiation will have a colour associated with it:</p><svg viewbox="0 0 200 75" fill=none height=450px id=bitarraySVG width=1200px><desc>Bit array.</desc><rect fill=#aaa height=150 id=bitarrayBG width=200 x=0 y=0 /></svg><p>The colours above have a corresponding chromaticity — and when mapped on the CIE xy chromaticity diagram, form the <a rel="noopener nofollow noreferrer" href=https://en.wikipedia.org/wiki/Planckian_locus target=_blank>planckian locus</a>:</p><svg viewbox="0 0 200 75" fill=none height=450px id=bitarraySVG width=1200px><desc>Bit array.</desc><rect fill=#aaa height=150 id=bitarrayBG width=200 x=0 y=0 /></svg><p>The <a rel="noopener nofollow noreferrer" href=https://en.wikipedia.org/wiki/Color_temperature target=_blank>colour temperature</a> is another way to describe certain colours and chromaticities — mostly different types of white. It is a common way to do it, as most physical sources of illumination have a chromaticity close to these values. Daylight, for example, has a chromaticity similar to a blackbody at temperatures ranging from 5000K to 6500K, and incandescent bulbs emit light having a colour temperature close to 2700K.<details><summary>Daylight colour temperature</summary> Incandescent bulbs have filaments heated to about 2000K to 2700K and thus have colour temperature close to that temperature. But the same is not true for sunlight as its colour temperature depends on the time of day. Due to <a rel="noopener nofollow noreferrer" href=https://en.wikipedia.org/wiki/Rayleigh_scattering target=_blank>rayleigh scattering</a>, shorter wavelengths of sunlight get scattered making it appear redder, while making skies and overcast light appear bluer. During mornings and evenings when the sun is lower in the sky, more light gets scattered causing sunlight to appear even redder (have a lower colour temperature). Daylight is the combination of all direct and indirect sunlight, and thus also depends on the time of day.</details><p>Most illuminants have chromaticty values that lie close to the planckian locus, but do not lie exactly on it — as most bodies are not perfect blackbodies. Also, incadescent lights have been phased out by <a rel="noopener nofollow noreferrer" href=https://en.wikipedia.org/wiki/Fluorescent_lamp#Color_temperature target=_blank>flourescent lights</a> and <a rel="noopener nofollow noreferrer" href=https://en.wikipedia.org/wiki/Light-emitting_diode#White_LEDs target=_blank>LEDs</a>, which do not use thermal radiation to emit light, and also do not lie on the planckian locus:</p><svg viewbox="0 0 200 75" fill=none height=450px id=bitarraySVG width=1200px><desc>Bit array.</desc><rect fill=#aaa height=150 id=bitarrayBG width=200 x=0 y=0 /></svg><p>While the chromaticity values of these illuminants do not lie on the planckian locus, they are still close enough to be perceptually similar to be meaningfully attributed to a colour temperature. These can be assigned a <a rel="noopener nofollow noreferrer" href=https://en.wikipedia.org/wiki/Correlated_color_temperature target=_blank>correlated colour temperature</a> based on the colour temperature it most closely resembles.<p>Correlated colour temperatures can also be mapped alongside the planckian locus:</p><svg viewbox="0 0 200 75" fill=none height=450px id=bitarraySVG width=1200px><desc>Bit array.</desc><rect fill=#aaa height=150 id=bitarrayBG width=200 x=0 y=0 /></svg><details open><summary>Correlated colour temperature lines</summary> The lines intersecting the planckian locus represent correlated colour temperatures. Two points on a correlated colour temperture line have the same correlated correlated colour temperature.</details><p>Correlated colour temperature can describe non-ideal blackbodies and other sources of white light. But since a single correlated colour temperature can correspond to multiple chromaticity values, it is not a precise way to describe white light.<p>To represent different types of white light in an umabiguous way, <a rel="noopener nofollow noreferrer" href=https://en.wikipedia.org/wiki/Standard_illuminant target=_blank>standard illuminants</a> have been defined — theoretical souces of light having a definitive spectral power distribution, and therefore an exact chromaticity value.</p><svg viewbox="0 0 200 75" fill=none height=450px id=bitarraySVG width=1200px><desc>Bit array.</desc><rect fill=#aaa height=150 id=bitarrayBG width=200 x=0 y=0 /></svg><p>Having a standard and precise way to define illumination sources is necessary because of <a rel="noopener nofollow noreferrer" href=https://en.wikipedia.org/wiki/Chromatic_adaptation target=_blank>chromatic adaptation</a>. Human colour perception adjusts for variations in illumination to preserve colours of objects. Two colours might appear white despite having different ‘true’ colours because of varying lighting conditions.</p><svg viewbox="0 0 200 75" fill=none height=450px id=bitarraySVG width=1200px><desc>Bit array.</desc><rect fill=#aaa height=150 id=bitarrayBG width=200 x=0 y=0 /></svg><details open><summary>Same colours under different lighting</summary> Same colours might look different under different lighting conditions and vice versa. <a rel="noopener nofollow noreferrer" href=https://en.wikipedia.org/wiki/The_dress target=_blank>The dress</a> is a popular example. The same colours can be perceived as either blue and black, or white and golden — depending on the perceived lighting.</details><p>Specifying a <a rel="noopener nofollow noreferrer" href=https://en.wikipedia.org/wiki/White_point target=_blank>white point</a> acts as a reference point for a colour space — to adjust for different viewing mediums and environments. Most colour spaces use the chromaticity of standard illuminants to define their white point.</p><svg viewbox="0 0 200 75" fill=none height=450px id=bitarraySVG width=1200px><desc>Bit array.</desc><rect fill=#aaa height=150 id=bitarrayBG width=200 x=0 y=0 /></svg><details open><summary>White as reference point</summary> Dragging the white point to <a href=switch#>D65</a> or <a href=switch#>4500K</a> shows how the chromaticity gets transformed to take into account the effects of <a rel="noopener nofollow noreferrer" href=https://en.wikipedia.org/wiki/Chromatic_adaptation target=_blank>chromatic adaptation</a>.</details><h2 id=Colour_Science>Colour Science</h2><p>Colours are a very interesting topic, because it involves quantifying something that feels innately qualitative. So far, only certain <a rel="noopener nofollow noreferrer" href=https://en.wikipedia.org/wiki/Additive_color target=_blank>additive colour models</a> have been discussed. But there are also <a rel="noopener nofollow noreferrer" href=https://en.wikipedia.org/wiki/Color_mixing target=_blank>other colour models</a>, such as the popular <a rel="noopener nofollow noreferrer" href=https://en.wikipedia.org/wiki/CMYK_color_model target=_blank>CMYK model</a>, which is a type of <a rel="noopener nofollow noreferrer" href=https://en.wikipedia.org/wiki/Subtractive_color target=_blank>subtractive colour model</a>.<p>Most of these topics involve ways to <a rel="noopener nofollow noreferrer" href=https://en.wikipedia.org/wiki/Colorimetry target=_blank>describe and recreate colours</a>. But there is also an entirely different branch of science that deals with the <a rel="noopener nofollow noreferrer" href=https://en.wikipedia.org/wiki/Color_psychology target=_blank>psychology of colours</a> — why and how certain <a rel="noopener nofollow noreferrer" href=https://en.wikipedia.org/wiki/Color_scheme target=_blank>colour combinations</a> appear pleasing, or how the <a rel="noopener nofollow noreferrer" href=https://en.wikipedia.org/wiki/Color_symbolism target=_blank>meaning of colours</a> vary across cultures. Or how colours can <a rel="noopener nofollow noreferrer" href=https://en.wikipedia.org/wiki/Color_psychology#Influence_of_color_on_perception target=_blank>affect other senses</a>.<p>The subject of colours is vast — spanning scientific domains from quantum physics and electromagnetism to physiology and psychology. This post is a very tiny fraction of what constitutes <a rel="noopener nofollow noreferrer" href=https://en.wikipedia.org/wiki/Color_science target=_blank>colour science</a>.<hr><h2 id=References>References</h2><ul><li>Jamie Wong: <a rel="noopener nofollow noreferrer" href=https://jamie-wong.com/post/color/ target=_blank>Color: From Hexcodes to Eyeballs</a><li>Bartosz Ciechanowski: <a rel="noopener nofollow noreferrer" href=https://ciechanow.ski/color-spaces/ target=_blank>Color Spaces</a><li>Douglas A. Kerr: <a rel="noopener nofollow noreferrer" href=https://graphics.stanford.edu/courses/cs148-10-summer/docs/2010--kerr--cie_xyz.pdf target=_blank>The CIE XYZ and xyY Color Spaces</a></ul></article></main><footer><a href=https://ekunazanu.dev/more#terms-of-use>© 2024</a> <a href=https://ekunazanu.dev>Anchit Roy</a> · <a rel="noopener nofollow noreferrer" href=https://creativecommons.org/licenses/by/4.0/ target=_blank>CC BY 4.0</a></footer>